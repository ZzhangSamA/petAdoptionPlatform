<!doctype html>
<html class="no-js" lang="zxx">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Marten - Pet Food eCommerce Bootstrap4 Template</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="assets/img/favicon.png">

    <!-- all css here -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/animate.css">
    <link rel="stylesheet" href="assets/css/simple-line-icons.css">
    <link rel="stylesheet" href="assets/css/themify-icons.css">
    <link rel="stylesheet" href="assets/css/owl.carousel.min.css">
    <link rel="stylesheet" href="assets/css/meanmenu.min.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/responsive.css">
    <script src="assets/js/vendor/modernizr-2.8.3.min.js"></script>

</head>
<body>
<header class="header-area">
    <div class="header-top theme-bg">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-md-4 col-12">
                    <div class="welcome-area">
                        <p>欢迎来到宠物领养平台! </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="header-bottom transparent-bar">
        <div class="container">
            <div class="row">
                <div class="col-xl-2 col-lg-3 col-md-4 col-sm-4 col-5">
                    <div class="logo pt-39">
                        <a href="index.html"><img alt="" src="assets/img/logo/logo.png"></a>
                    </div>
                </div>
                <!--头部导航栏-->
                <div class="col-xl-8 col-lg-7 d-none d-lg-block">
                    <div class="main-menu text-center">
                        <nav>
                            <ul>
                                <li><a href="index.html">主页</a>
                                    <ul class="submenu">
                                        <li>
                                            <a href="index.html">主页版本1</a>
                                        </li>
                                        <li>
                                            <a href="index-2.html">主页版本2</a>
                                        </li>
                                    </ul>
                                </li>
                                <li class="mega-menu-position"><a href="shop-page.html">商城</a>
                                    <ul class="mega-menu" id="goodsTypeDate">

                                    </ul>
                                </li>
                                <li><a href="my-account.html">个人中心</a></li>
                                <li><a href="myOrder.html">我的订单</a></li>
                                <li><a href="blog-leftsidebar.html">博客</a></li>
                                <li><a href="contact.html">联系我们</a></li>
                            </ul>
                        </nav>
                    </div>
                </div>                        <div class="col-xl-2 col-lg-2 col-md-8 col-sm-8 col-7">
                <div class="search-login-cart-wrapper">
                    <div class="header-search same-style">
                        <button class="search-toggle">
                            <i class="icon-magnifier s-open"></i>
                            <i class="ti-close s-close"></i>
                        </button>
                        <div class="search-content">
                            <form action="#">
                                <input type="text" placeholder="Search">
                                <button>
                                    <i class="icon-magnifier"></i>
                                </button>
                            </form>
                        </div>
                    </div>
                    <div class="header-login same-style">
                        <a href="login-register.html"><i class="icon-user icons"></i></a>
                    </div>
                    <div class="header-cart same-style">
                        <button class="icon-cart">
                            <i class="icon-handbag"></i>
                            <span class="count-style"></span>
                        </button>
                        <div class="shopping-cart-content">
                            <ul>
                                <li class="single-shopping-cart">
                                    <div class="shopping-cart-img">
                                        <a href="#"><img alt="" src="assets/img/cart/cart-1.jpg"></a>
                                    </div>
                                    <div class="shopping-cart-title">
                                        <h4><a href="#">Dog Calcium Food </a></h4>
                                        <h6>Qty: 02</h6>
                                        <span>$260.00</span>
                                    </div>
                                    <div class="shopping-cart-delete">
                                        <a href="#"><i class="ti-close"></i></a>
                                    </div>
                                </li>
                                <li class="single-shopping-cart">
                                    <div class="shopping-cart-img">
                                        <a href="#"><img alt="" src="assets/img/cart/cart-2.jpg"></a>
                                    </div>
                                    <div class="shopping-cart-title">
                                        <h4><a href="#">Dog Calcium Food</a></h4>
                                        <h6>Qty: 02</h6>
                                        <span>$260.00</span>
                                    </div>
                                    <div class="shopping-cart-delete">
                                        <a href="#"><i class="ti-close"></i></a>
                                    </div>
                                </li>
                            </ul>
                            <div class="shopping-cart-total">
                                <h4>Shipping : <span>$20.00</span></h4>
                                <h4>Total : <span class="shop-total">$260.00</span></h4>
                            </div>
                            <div class="shopping-cart-btn">
                                <a href="cart.html">view cart</a>
                                <a href="checkout.html">checkout</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
                <div class="mobile-menu-area electro-menu d-md-block col-md-12 col-lg-12 col-12 d-lg-none d-xl-none">
                    <div class="mobile-menu">
                        <nav id="mobile-menu-active">
                            <ul class="menu-overflow">
                                <li><a href="#">HOME</a>
                                    <ul>
                                        <li><a href="index.html">home version 1</a></li>
                                        <li><a href="index-2.html">home version 2</a></li>
                                    </ul>
                                </li>
                                <li><a href="#">pages</a>
                                    <ul>
                                        <li>
                                            <a href="about-us.html">about us</a>
                                        </li>
                                        <li>
                                            <a href="shop-page.html">shop page</a>
                                        </li>
                                        <li>
                                            <a href="shop-list.html">shop list</a>
                                        </li>
                                        <li>
                                            <a href="product-details.html">product details</a>
                                        </li>
                                        <li>
                                            <a href="cart.html">cart page</a>
                                        </li>
                                        <li>
                                            <a href="checkout.html">checkout</a>
                                        </li>
                                        <li>
                                            <a href="wishlist.html">wishlist</a>
                                        </li>
                                        <li>
                                            <a href="contact.html">contact us</a>
                                        </li>
                                        <li>
                                            <a href="my-account.html">my account</a>
                                        </li>
                                        <li>
                                            <a href="login-register.html">login / register</a>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="#">Food</a>
                                    <ul>
                                        <li><a href="#">Dogs Food</a>
                                            <ul>
                                                <li><a href="shop-page.html">Grapes and Raisins</a></li>
                                                <li><a href="shop-page.html">Carrots</a></li>
                                                <li><a href="shop-page.html">Peanut Butter</a></li>
                                                <li><a href="shop-page.html">Salmon fishs</a></li>
                                                <li><a href="shop-page.html">Eggs</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#">Cats Food</a>
                                            <ul>
                                                <li><a href="shop-page.html">Meat</a></li>
                                                <li><a href="shop-page.html">Fish</a></li>
                                                <li><a href="shop-page.html">Eggs</a></li>
                                                <li><a href="shop-page.html">Veggies</a></li>
                                                <li><a href="shop-page.html">Cheese</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#">Fishs Food</a>
                                            <ul>
                                                <li><a href="shop-page.html">Rice</a></li>
                                                <li><a href="shop-page.html">Veggies</a></li>
                                                <li><a href="shop-page.html">Cheese</a></li>
                                                <li><a href="shop-page.html">wheat bran</a></li>
                                                <li><a href="shop-page.html">Cultivation</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="#">blog</a>
                                    <ul>
                                        <li>
                                            <a href="blog.html">blog page</a>
                                        </li>
                                        <li>
                                            <a href="blog-leftsidebar.html">blog left sidebar</a>
                                        </li>
                                        <li>
                                            <a href="blog-details.html">blog details</a>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="contact.html"> Contact us </a></li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
<div class="breadcrumb-area pt-95 pb-95 bg-img" style="background-image:url(assets/img/banner/banner-2.jpg);">
    <div class="container">
        <div class="breadcrumb-content text-center">
            <h2>个人信息</h2>
            <ul>
                <li><a href="index.html">home</a></li>
                <!--<li class="active">My Account</li>-->
            </ul>
        </div>
    </div>
</div>
<!-- my account start -->
<div class="my-account-area pt-100 pb-70">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="checkout-wrapper">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h5 class="panel-title"><span>1</span> <a data-toggle="collapse" data-parent="#faq" href="#my-account-3">选择地址 </a></h5>
                            </div>
                            <div id="my-account-3" class="panel-collapse collapse">
                                <div class="panel-body">
                                    <table class="col-lg-12 col-md-12" id="dataTable">
                                        <thead>
                                        <tr >
                                            <th style="width: 100px ;text-align: center">选择地址</th>
                                            <th style="width: 130px ;text-align: center">性别</th>
                                            <th style="width: 130px ;text-align: center">姓名</th>
                                            <th style="width: 130px ;text-align: center">电话号码</th>
                                            <th style="width: 130px ;text-align: center">邮编</th>
                                            <th style="width: 500px ;text-align: center">收货地址</th>
                                            <th width="100" style="text-align: center">更改地址</th>
                                            <th width="100" style="text-align: center">删除地址</th>
                                        </tr>
                                        </thead>
                                        <tbody id="tbody">
                                        </tbody>
                                        <thead>
                                        <div style="text-align: center">
                                            <a href="add-Address.html" ><h4 style="color:brown">增加地址</h4></a>
                                        </div>

                                        </thead>
                                    </table>
                                </div>
                            </div>


                        </div>

                    </div>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h5 class="panel-title"><span>2</span> <a data-toggle="collapse" data-parent="#faq" href="#my-account-2">商品详情 </a></h5>
                    </div>
                    <div id="my-account-2" class="panel-collapse collapse">
                        <div class="panel-body">
                            <!--<div class="billing-information-wrapper">-->
                                <!--<div class="account-info-wrapper">-->
                                    <!--<h4>Change Password</h4>-->
                                    <!--<h5>Your Password</h5>-->
                                <!--</div>-->
                                <!--<div class="row">-->
                                    <!--<div class="col-lg-12 col-md-12">-->
                                        <!--<div class="billing-info">-->
                                            <!--<label>Password</label>-->
                                            <!--<input type="password">-->
                                        <!--</div>-->
                                    <!--</div>-->
                                    <!--<div class="col-lg-12 col-md-12">-->
                                        <!--<div class="billing-info">-->
                                            <!--<label>Password Confirm</label>-->
                                            <!--<input type="password">-->
                                        <!--</div>-->
                                    <!--</div>-->
                                <!--</div>-->
                                <!--<div class="billing-back-btn">-->
                                    <!--<div class="billing-back">-->
                                        <!--<a href="#"><i class=" ti-arrow-up"></i> back</a>-->
                                    <!--</div>-->
                                    <!--<div class="billing-btn">-->
                                        <!--<button type="button">Continue</button>-->
                                    <!--</div>-->
                                <!--</div>-->
                            <!--</div>-->
                            <table class="col-lg-12 col-md-12">
                                <thead >
                                <tr>
                                    <th style="width: 100px ;text-align: center">
                                        商品名称
                                    </th>
                                    <th style="width: 100px ;text-align: center">规格</th>
                                    <th style="width: 100px ;text-align: center">单价</th>
                                    <th style="width: 100px ;text-align: center">数量</th>
                                    <th style="width: 100px ;text-align: center">总价</th>
                                </tr>
                                </thead>
                                <tbody class="order">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                </div>

            <div><a class="transaction-status" href="JavaScript:void(0)" style="text-align: center" onclick="addGoodsOrder()">确认订单</a></div>
            </div>
        </div>
    </div>
</div>
<footer class="footer-area">
    <div class="footer-top pt-80 pb-50 gray-bg-2">
        <div class="container">
            <div class="row">
                <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6">
                    <div class="footer-widget mb-30">
                        <div class="footer-info-wrapper">
                            <div class="footer-logo">
                                <a href="#">
                                    <img src="assets/img/logo/logo-2.png" alt="">
                                </a>
                            </div>
                            <p>Lorem ipsum dolor sit amet, co adipisi elit, sed eiusmod tempor incididunt ut labore et dolore</p>
                            <div class="social-icon">
                                <ul>
                                    <li><a href="#"><i class="icon-social-twitter"></i></a></li>
                                    <li><a href="#"><i class="icon-social-instagram"></i></a></li>
                                    <li><a href="#"><i class="icon-social-linkedin"></i></a></li>
                                    <li><a href="#"><i class="icon-social-skype"></i></a></li>
                                    <li><a href="#"><i class="icon-social-dribbble"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6">
                    <div class="footer-widget mb-30 pl-50">
                        <h4 class="footer-title">USEFUL LINKS</h4>
                        <div class="footer-content">
                            <ul>
                                <li><a href="#">Help & Contact Us</a></li>
                                <li><a href="#">Returns & Refunds</a></li>
                                <li><a href="#">Online Stores</a></li>
                                <li><a href="#">Terms & Conditions</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-2 col-md-6 col-sm-6">
                    <div class="footer-widget mb-30 pl-70">
                        <h4 class="footer-title">HELP</h4>
                        <div class="footer-content">
                            <ul>
                                <li><a href="#">Faq's </a></li>
                                <li><a href="#">Pricing Plans</a></li>
                                <li><a href="#">Order Traking</a></li>
                                <li><a href="#">Returns </a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6">
                    <div class="footer-widget">
                        <div class="newsletter-wrapper">
                            <p>Subscribe to our newsletter and get 10% off your first purchase..</p>
                            <div class="newsletter-style">
                                <div id="mc_embed_signup" class="subscribe-form">
                                    <form action="#" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
                                        <div id="mc_embed_signup_scroll" class="mc-form">
                                            <input type="email" value="" name="EMAIL" class="email" placeholder="Your mail address" required>
                                            <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                                            <div class="mc-news" aria-hidden="true"><input type="text" name="b_6bbb9b6f5827bd842d9640c82_05d85f18ef" tabindex="-1" value=""></div>
                                            <div class="clear"><input type="button" value="SEND" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="payment-img">
                            <a href="index.html">
                                <img src="assets/img/icon-img/payment.png" alt="">
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-bottom gray-bg-3 pt-17 pb-15">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="copyright text-center">
                        <p>Copyright © <a href="http://www.bootstrapmb.com/">Marten</a> All Right Reserved.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>




<!-- all js here -->
<script src="assets/js/vendor/jquery-1.12.0.min.js"></script>

<script src="assets/js/popper.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/jquery.counterup.min.js"></script>
<script src="assets/js/waypoints.min.js"></script>
<script src="assets/js/elevetezoom.js"></script>
<script src="assets/js/ajax-mail.js"></script>
<script src="assets/js/owl.carousel.min.js"></script>
<script src="assets/js/plugins.js"></script>
<script src="assets/js/main.js"></script>



<script type="text/javascript">

    initPage();
    function initPage(){
        // $("#tbody").empty("");
        $.ajax({
            type: 'GET',
            url: 'selectFromAddress',
            // data:{
            //     "customerId":customerId
            // },
            traditional: true,
            success:function (response) {
                console.log(response);
                var sexx = null;
                $(response).each(function (index,item) {
                    if(item.sex==0){
                        sexx = "保密";
                    }else if(item.sex==1){
                        sexx = "男";
                    }else {
                        sexx = "女";
                    }

                    $("#tbody").append("<tr>"+
                        // "<td style=\"text-align: center\">"+index+"</td>"+
                        "<td style=\"text-align: center\"><input  value='"+item.isDefault+"' onclick='getAddress("+item.addressId+")' name='defaultsAddress' type=\"radio\" style=\" height: 20px;\"></td>"+
                        "<td style=\"text-align: center\">"+sexx+"</td>"+
                        "<td style=\"text-align: center\">"+item.name+"</td>"+
                        "<td style=\"text-align: center\">"+item.phone+"</td>"+
                        "<td style=\"text-align: center\">"+item.postalCode+"</td>"+
                        "<td style=\"text-align: center\">"+item.address+"</td>"+
                        // "<td class=\"billing-btn\" style=\"text-align: center\">"+
                        // " <button type='button' onclick='jumpAdd("+item.customerId+")'>增加</button>"+
                        // "</td>"+
                        "<td class=\"billing-btn\" style=\"text-align: center\">"+
                        " <button type='button' onclick='jumpToEdit("+item.addressId+")'>修改</button>"+
                        "</td>"+
                        "<td class=\"billing-btn\" style=\"text-align: center\">"+
                        " <button type='button' onclick='remove("+item.addressId+")'>删除</button>"+
                        "</td>"+
                        "</tr>");
                })
                $("input:radio[name=defaultsAddress]").each(function(i,val){
                    // console.log(val)
                    // var $vall = $(val)
                    // console.log($vall)
                    if (val.value==1){
                        val.checked="checked";
                    }
                });
                // if ($("input:radio[name=defaultsAddress]:checked").length == $("input:checkbox[name=defaultsAddress]").length) {
                //     $("#allElection").prop("checked", true);
                // }else {
                //     $("#allElection").prop("checked", false);
                // }
            },
            error:function (response) {
                console.log(response)
            },
            // dataType: 'json'
        });
    }
    //删除地址
    function remove(addressId) {
        $.ajax({
            type: "POST",//数据发送的方式（post 或者 get）
            url: "remove",//要发送的后台地址
            data: {"addressId": addressId}
            ,//要发送的数据（参数）格式为{'val1':"1","val2":"2"}
            dataType: "json",//后台处理后返回的数据格式
            success: function (responseText) {//ajax请求成功后触发的方法
                if (responseText == true) {
                    window.location.href = "my-account.html";
                } else {
                    alert('删除失败');
                }
            },
            error: function (msg) {//ajax请求失败后触发的方法
                alert(msg);//弹出错误信息
            }

        });
    }
    // 选定默认
    function defaultsChange(addressId) {
        //1.提交数据到服务器并获取返回值
        $.ajax({

            type: 'POST',
            url: 'defaultAddress',
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify({
                //"customerId":customerId,
                "addressId":addressId,
            }),
            //2.根据返回值提示并跳转
            success:function (response) {
                if(response==true){
                    alert("更改默认地址成功");
                }else{
                    alert("修改失败");
                }
            },
            error:function (response) {
                alert("服务器内部错误,修改失败");
            },
            dataType: 'json'
        })
    }

    function jumpToEdit(addressId) {
        var url = "change-address.html?addressId="+addressId;
        window.location.href = url;
    }
    // function jumpAdd(customerId) {
    //     var urll = "add-Address.html?customerId";
    //     window.location.href =urll ;
    // }

    //信息回显




</script>
<script type="text/javascript">

    var addressId=0;
   var search = location.search;
   var status = search.split("=")[1];
   if(status!=1)
   { var goodsId=search.split("goodsId=")[1].split("&&")[0];
       var parameterId=search.split("parameterId=")[1].split("&&")[0];
       var number=search.split("number=")[1].split("&&")[0];
   }

   getOrder();
    function getOrder() {
        if (status == 1) {
            $.ajax({
                async: true,
                cache: false,
                traditional: true,
                type: "POST",
                url: "getCart",
                contentType: "application/json;charset=utf-8",
                success:function(text){
                    var String="";
                    $(text).each(function (index,item) {
                        String+="<tr style='border: 1px solid;margin: 5% auto;height: 50px'>" +
                            "<td style=\"text-align: center;border-right: 1px solid;\">"+item.goodsName+"</td>" +
                                "<td style=\"text-align: center;border-right: 1px solid;\">"+item.parameterName+"</td>"+
                                "<td style=\"text-align: center;border-right: 1px solid;\">"+item.price+"</td>"+
                            "<td style=\"text-align: center;border-right: 1px solid;\">"+item.number+"</td>"+
                                "<td style=\"text-align: center;border-right: 1px solid;\">"+item.totalPrice+"</td>"
                            "</tr>"
                    });
                    console.log(String)
                    $(".order").append(String)

                },
                error: function (text) {
                    alert("服务器错误，确认失败");
                },

                dataType: "json"
            });
        }else {
            $.ajax({
                async: true,
                cache: false,
                traditional: true,
                type: "POST",
                url: "getOneGoods",
                data: JSON.stringify({
                    "goodsId":goodsId,
                    "parameterId":parameterId
                }),
                contentType: "application/json;charset=utf-8",
                success:function(item){
                    var String="";
                        var price = item.price;
                        var totalPrice=Number(number)*price;
                        String+="<tr style='border: 1px solid;margin: 5% auto;height: 50px'>" +
                            "<td style=\"text-align: center;border-right: 1px solid;\">"+item.goodsName+"</td>" +
                            "<td style=\"text-align: center;border-right: 1px solid;\">"+item.parameterName+"</td>"+
                            "<td style=\"text-align: center;border-right: 1px solid;\">"+price+"</td>"+
                            "<td style=\"text-align: center;border-right: 1px solid;\">"+number+"</td>"+
                            "<td style=\"text-align: center;border-right: 1px solid;\">"+totalPrice+"</td>"
                        "</tr>"

                    console.log(String)
                    $(".order").append(String)

                },
                error: function (text) {
                    alert("服务器错误，确认失败");
                },

                dataType: "json"
            });
        }

    }
    function getAddress(id) {
        addressId=id;
    }

    function addGoodsOrder() {
        if (status==1){
            $.ajax({
                async: true,
                cache: false,
                traditional: true,
                type: "POST",
                url: "addOrder",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    "addressId":addressId,
                    "status":status
                }),
                success:function(text){
                    if (text >= 1) {
                        window.location.href="myOrder.html"
                    }else {
                        alert("添加订单失败，请确认是否添加收货地址")
                    }


                },
                error: function (text) {
                    alert("服务器错误，确认失败");
                },

                dataType: "json"
            });
        }
        else {
            $.ajax({
                async: true,
                cache: false,
                traditional: true,
                type: "POST",
                url: "addOrder",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    "addressId":addressId,
                    "status":2,
                    "goodsId":goodsId,
                    "parameterId":parameterId,
                    "number":number
                }),
                success:function(text){
                    if (text >= 1) {
                        window.location.href="myOrder.html"
                    }else {
                        alert("添加订单失败，请确认是否添加收货地址")
                    }


                },
                error: function (text) {
                    alert("服务器错误，确认失败");
                },

                dataType: "json"
            });
        }

    }

</script>
</body>
</html>
